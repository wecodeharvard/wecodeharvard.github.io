/*!CK:944612977!*//*1418647484,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["t4XZI"]); }

__d("XPokeLiveControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/pokes\/live\/",{poke_source:{type:"Int",required:true}});},null);
__d("PokeUtility",["CSS","PokeCSSConfig","XPokeLiveControllerURIBuilder","ge"],function(a,b,c,d,e,f,g,h,i,j){var k={};e.exports.shouldActOn=function(l,m){if(!l||!m)return false;if(!(l in k)){k[l]={poke_time:true};return true;}if(!(m in k[l])){k[l][m]=true;return true;}return false;};e.exports.getLivePokeURI=function(l){return (new i()).setInt('poke_source',l).getURI();};e.exports.hideExistingLivePoke=function(l){var m=j(h.live_empty);if(m)g.hide(m);var n=j(h.live_item+l);if(n)g.hide(n);};},null);
__d("XPokeDialogControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/pokes\/dialog\/",{do_confirm:{type:"Bool"},poke_target:{type:"Int"},__asyncDialog:{type:"Int"}});},null);
__d("Poke",["Arbiter","AsyncRequest","ChannelConstants","PokeUtility","XPokeDialogControllerURIBuilder"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m,n){var o=n.obj.poke_source,p=n.obj.poke_time;if(!j.shouldActOn(o,p))return;var q=j.getLivePokeURI(o);(new h()).setURI(q).send();j.hideExistingLivePoke(o);}e.exports.init=function(m){g.subscribe(i.getArbiterType('live_poke'),l);m.getView().subscribe("afterSelect",function(){var n=m.getCore().getHiddenValue();if(n!==''){var o=(new k()).setInt('poke_target',n).getURI();new h().setURI(o).setNectarModuleDataSafe(m.getView().getElement()).send();m.getCore().reset();}return true;});};},null);
__d("HubsTypeaheadView",["Arbiter","AsyncRequest","ContextualTypeaheadView","CSS","DOM","Event","$","copyProperties","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){for(var p in i)if(i.hasOwnProperty(p))r[p]=i[p];var q=i===null?null:i.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=i;function r(s,t){"use strict";i.call(this,s,t);if(t.allowDedupe)this.subscribe('select',this.selectDuplicates.bind(this));}r.prototype.hide=function(){"use strict";return this.canHide?q.hide.call(this):null;};r.prototype.reset=function(){"use strict";return this.canHide?q.reset.call(this):null;};r.prototype._createFreeFormNode=function(s){"use strict";var t=s;if(this.showCreatePrompt){t=o._("Add \"{partial_name}\"",[o.param("partial_name",s)]);}else if(this.showAltCreatePrompt)t=o._("Create \"{partial_name}\"",[o.param("partial_name",s)]);return {text:t,orig_text:s,type:'addnew calltoaction',uid:'0'};};r.prototype.render=function(s,t,u){"use strict";var v=[],w=Math.max(1,Math.floor(t.length/10));for(var x=w;x<t.length;x++)if(!!t[x].already_added){v.push(t[x]);t.splice(x,1);x--;}t=t.concat(v);if(this.alwaysRender&&s!=='')if(this.allowFreeformEntry){t.push(this._createFreeFormNode(s));}else{var y=s.toLowerCase().trim(),z=false;for(var aa=0;aa<t.length;aa++)if(y==t[aa].text.toLowerCase().trim()){z=true;break;}if(!z)t.push(this._createFreeFormNode(s));}var ba=t.length;for(var ca=0;ca<t.length;ca++)if(t[ca].uid==false)ba--;if(this.allowDedupe&&ba>1&&s.length>=3)t.push({text:"Mark Duplicate Results",type:'dupelink calltoaction'});return q.render.call(this,s,t,u);};r.prototype.selectDuplicates=function(s,t){"use strict";if(!t.selected.type.match('dupelink'))return;var u=[];for(var v=0;v<this.results.length;v++){if(this.results[v].uid==false)continue;u.push(this.results[v].uid);}var w=g.subscribe('typeahead/'+this.collectionID+'/confirmDupes',function(x,y){var z=this.results.map(function(ca){return ca.uid;});for(var aa=0;aa<y.dupe_ids.length;aa++){var ba=z.indexOf(y.dupe_ids[aa]);j.hide(this.items[ba]);}this.hasHiddenDupes=y.dupe_ids.length>0;}.bind(this));g.subscribe('typeahead/'+this.collectionID+'/finishDupes',function(x,y){g.unsubscribe(w);this.canHide=true;this.hasHiddenDupes&&j.hide(k.find(this.content,'.dupelink'));this.hasHiddenDupes=false;}.bind(this));this.canHide=false;new h('/ajax/typeahead/quality/duplicates').setData({ids:u,surface:m('collections_surface').value,collection_id:this.collectionID}).send();};r.initFreeformBoxes=function(){"use strict";var s=k.scry(document,'div.fbAddFormDialog')[0];if(!s)return;var t=k.find(s,'form');l.listen(t,'submit',function(){k.scry(t,'div.fbFreeformInput').forEach(function(u){if(k.find(u,'input.inputtext').value)j.addClass(u.firstChild,'selected');});});};n(r.prototype,{canHide:true,hasHiddenDupes:false});e.exports=r;},null);
__d("TimelineAboutUnitAddCityDialog",["AsyncRequest","Button","CSS","DOMQuery","Event"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m,n,o,p,q,r){"use strict";this._dialog=n;var s=n.getRoot();this._icon=m;this._typeahead=o;this._radioCities=j.scry(s,'input[type="radio"]');this._textOther=j.find(s,'.textOther');this._buttonSave=j.scry(s,'button[name="save"]')[0];this._buttonClose=j.scry(s,'a.layerCancel')[0];this._form=j.scry(s,'form[name="city_form"]')[0];this._ref=q;this._uri=r;if(this._radioCities.length>0){this._radioCityOther=j.find(s,'.radioCityOther');this._typeahead.subscribe('select',this._enableSaveButtonTypeahead.bind(this));this._typeahead.subscribe('unselect',this._disableSaveButtonTypeahead.bind(this));for(var t=0;t<this._radioCities.length-1;t++)k.listen(this._radioCities[t],'click',this._enableSaveButton.bind(this));k.listen(this._radioCityOther,'click',this._saveButtonCityOther.bind(this));}else{this._typeahead.subscribe('select',this._enableSaveButton.bind(this));this._typeahead.subscribe('unselect',this._disableSaveButton.bind(this));}k.listen(m,'click',this._onIconClick.bind(this));if(this._radioCityOther){k.listen(this._textOther,'focus',this._selectRadioOther.bind(this));k.listen(this._radioCityOther,'click',this._focusTextOther.bind(this));}if(p)n.show();k.listen(this._buttonClose,'click',this._onClose.bind(this));k.listen(this._form,'submit',this._onSubmit.bind(this));}l.prototype._onSubmit=function(){"use strict";var m=false;if(this._radioCities.length===0){if(this._typeahead.getCore().getHiddenValue()!=='')m=true;}else{for(var n=0;n<this._radioCities.length-1;n++)if(this._radioCities[n].checked){m=true;break;}if(this._radioCityOther.checked)if(this._typeahead.getCore().getHiddenValue()!==''){m=true;}else m=false;}if(m){i.hide(this._icon);}else this._onClose();};l.prototype._onIconClick=function(m){"use strict";new g().setURI(this._uri).setData({log:'icon_clicked',ref:this._ref}).setMethod('POST').send();m.prevent();this._dialog.show();};l.prototype._onClose=function(){"use strict";new g().setURI(this._uri).setData({log:'close_clicked',ref:this._ref}).setMethod('POST').send();};l.prototype._focusTextOther=function(){"use strict";this._textOther.focus();};l.prototype._selectRadioOther=function(){"use strict";this._radioCityOther.checked=true;if(this._typeahead.getCore().getHiddenValue()!==''){h.setEnabled(this._buttonSave,true);}else h.setEnabled(this._buttonSave,false);};l.prototype._enableSaveButton=function(){"use strict";h.setEnabled(this._buttonSave,true);};l.prototype._disableSaveButton=function(){"use strict";h.setEnabled(this._buttonSave,false);};l.prototype._enableSaveButtonTypeahead=function(){"use strict";if(this._radioCityOther.checked)h.setEnabled(this._buttonSave,true);};l.prototype._disableSaveButtonTypeahead=function(){"use strict";if(this._radioCityOther.checked)h.setEnabled(this._buttonSave,false);};l.prototype._saveButtonCityOther=function(){"use strict";if(this._typeahead.getCore().getHiddenValue()!==''){h.setEnabled(this._buttonSave,true);}else h.setEnabled(this._buttonSave,false);};e.exports=l;},null);
__d("TypeaheadRequireSelection",["Event","copyProperties"],function(a,b,c,d,e,f,g,h){function i(j){"use strict";this._typeahead=j;}i.prototype.enable=function(){"use strict";var j=this._typeahead.getCore(),k=j.getElement().form;function l(){!j.getHiddenValue()&&j.reset();}l();this._subscription=j.subscribe('blur',l);if(k)this._eventListener=g.listen(k,'submit',l);};i.prototype.disable=function(){"use strict";this._typeahead.getCore().unsubscribe(this._subscription);this._subscription=null;if(this._eventListener){this._eventListener.remove();this._eventListener=null;}};h(i.prototype,{_subscription:null,_eventListener:null});e.exports=i;},null);
__d("legacy:RequireSelectionTypeaheadBehavior",["TypeaheadRequireSelection"],function(a,b,c,d,e,f,g){if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.requireSelection=function(h){h.enableBehavior(g);};},3);
__d("TypeaheadSetPhotoOnSelect",["CSS","DOM","Event","copyProperties"],function(a,b,c,d,e,f,g,h,i,j){function k(l){"use strict";this._typeahead=l;}k.prototype.enable=function(){"use strict";var l=h.scry(this._typeahead.getElement(),'.photo')[0];if(l){if(!h.isNodeOfType(l,'img')){var m=h.create('img',{className:l.className});h.replace(l,m);l=m;}var n=g.hide.bind(null,l),o=g.show.bind(null,l);this._eventListener=i.listen(l,{load:o,error:n,abort:n});this._subscription=this._typeahead.subscribe('select',function(p,q){var r=q.selected.photo||this._typeahead.view.fallbackPhoto;r?l.setAttribute('src',r):n();}.bind(this));}};k.prototype.disable=function(){"use strict";this._eventListener.remove();this._eventListener=null;this._typeahead.unsubscribe(this._subscription);this._subscription=null;};j(k.prototype,{_eventListener:null,_subscription:null});e.exports=k;},null);
__d("legacy:SetPhotoOnSelectTypeaheadBehavior",["TypeaheadSetPhotoOnSelect"],function(a,b,c,d,e,f,g){if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.setPhotoOnSelect=function(h){h.enableBehavior(g);};},3);