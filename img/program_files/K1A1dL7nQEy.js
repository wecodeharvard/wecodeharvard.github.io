/*!CK:1648903795!*//*1418739435,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["+SCnR"]); }

__d("CustomCallToActionConstants",[],function(a,b,c,d,e,f){e.exports={WEB_UNIT:"WEB_UNIT",IOS_UNIT:"IOS_UNIT",ANDROID_UNIT:"ANDROID_UNIT",WEB:"CUSTOM_CTA_PLATFORM_WEB",IOS:"CUSTOM_CTA_PLATFORM_IOS",ANDROID:"CUSTOM_CTA_PLATFORM_ANDROID",PRIMARY_LINK:"customCTAEditPrimaryLink",PRIMARY_LINK_TYPE:"customCTAEditPrimaryLinkType",FALLBACK_LINK_TYPE:"customCTAEditFallbackLinkType",FALLBACK_LINK:"customCTAEditFallbackLink",APP_ID:"appID",GK_BYPASS:"pages_custom_cta_bypass",GK_PID:"pages_custom_cta_pid",GK_UID:"pages_custom_cta_uid",GK_CONTEXTUAL_ROW_UID:"pages_custom_cta_contextual_row_uid",GK_CONTEXTUAL_ROW_ADMIN_UID:"pages_custom_cta_contextual_row_admin_uid",GK_FOLLOW_BUTTON_IN_LIKE_DROPDOWN:"pages_follow_button_in_like_dropdown",GK_SHOW_IN_SPRINGBOARD_UID:"pages_custom_cta_show_in_springboard_uid",GK_ADMIN_UID:"custom_cta_admin_uid",GK_PROMOTION_ADMIN_UID:"custom_cta_promotion_admin_uid",GK_CUSTOM_CTA_CALLOUT:"custom_cta_callout",QE_PID_BETA:"custom_cta_pid_beta",NECTAR_APP_NAME:"custom_cta",OPEN_APP_ID:1,OPEN_WEBSITE_ID:2};},null);
__d("CustomCallToActionLinkTypes",[],function(a,b,c,d,e,f){e.exports={NONE:"",APP_URL:"APP_URL",DESKTOP_URL:"DESKTOP_URL",MSITE_URL:"MSITE_URL",PACKAGE_NAME:"PACKAGE_NAME",STORE_ID:"STORE_ID"};},null);
__d("CustomCallToActionTypes",[],function(a,b,c,d,e,f){e.exports={NONE:"",BOOK_NOW:"BOOK_NOW",CONTACT_US:"CONTACT_US",OPEN_APP:"OPEN_APP",GO_TO_WEBSITE:"GO_TO_WEBSITE",INSTALL_APP:"INSTALL_APP",PLAY_NOW:"PLAY_NOW",SHOP_NOW:"SHOP_NOW",SIGN_UP:"SIGN_UP",WATCH_NOW:"WATCH_NOW"};},null);
__d("CctaDispatcher",["Dispatcher","copyProperties"],function(a,b,c,d,e,f,g,h){'use strict';var i=[],j=h(new g(),{cctaDispatch:function(k){this.dispatch(k);var l=i;i=[];l.forEach(function(m){m();});i.length=0;},addPostDispatchCallback:function(k){if(this.isDispatching()){i.push(k);}else k();}});e.exports=j;},null);
__d("CctaConfirmationDialog.react",["fbt","CctaDispatcher","LayerHideOnBlur","React","XUIContextualDialog.react","XUIContextualDialogBody.react","XUIContextualDialogFooter.react","XUIContextualDialogTitle.react","XUIDialogButton.react"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';var p=j.createClass({displayName:"CctaConfirmationDialog",propTypes:{createButton:j.PropTypes.object.isRequired,pageid:j.PropTypes.number.isRequired},onClick:function(){h.dispatch({actionType:'delete-confirmation-dialog',data:this.props.pageid});},render:function(){return (j.createElement(k,{alignment:"center",behaviors:{LayerHideOnBlur:i},context:this.props.createButton.getDOMNode(),onToggle:this.onClick,position:"left",shown:true,width:350},j.createElement(n,null,"View Your Results"),j.createElement(l,null,"Check here to see how many times your call-to-action(CTA) button has been clicked in the last 7 days."),j.createElement(m,null,j.createElement(o,{action:"cancel",label:"Finish",onClick:this.onClick,use:"confirm"}))));}});e.exports=p;},null);
__d("CustomCTAConstants",["fbt","CustomCallToActionConstants","CustomCallToActionLinkTypes","CustomCallToActionTypes"],function(a,b,c,d,e,f,g,h,i,j){var k={NO_DIALOG:'CUSTOM_CTA_DIALOG_NONE',DELETE_DIALOG:'CUSTOM_CTA_DIALOG_DELETE',EDIT_DIALOG:'CUSTOM_CTA_DIALOG_EDIT',PROMOTE_DIALOG:'CUSTOM_CTA_DIALOG_PROMOTE',OPEN_APP_ID:1,OPEN_WEBSITE_ID:2,SHOW_FLYOUT:'SHOW_FLYOUT',CREATE_DIALOG_WIDTH:778,CREATE_DIALOG_HEIGHT:504,PREVIEW_WIDTH:436,PREVIEW_HEIGHT:416,SELECTOR_WIDTH:194,URI_TRUNCATE_LENGTH:30,CREATE_CTA_TYPE_OPTIONS:[j.BOOK_NOW,j.CONTACT_US,j.OPEN_APP,j.PLAY_NOW,j.SHOP_NOW,j.SIGN_UP,j.WATCH_NOW],PLATFORM_TYPE:'CUSTOM_CTA_PLATFORM_TYPE',WEB:h.WEB,IOS:h.IOS,ANDROID:h.ANDROID,APP_ID:h.APP_ID,FALLBACK_LINK_TYPE:h.FALLBACK_LINK_TYPE,FALLBACK_LINK:h.FALLBACK_LINK,PRIMARY_LINK:h.PRIMARY_LINK,PRIMARY_LINK_TYPE:h.PRIMARY_LINK_TYPE,EDIT_LINK_TYPE_OPTIONS:[i.APP_URL,i.DESKTOP_URL],FALLBACK_INSTALL_APP:'fallback_install_app',FALLBACK_GO_TO_WEBSITE:'fallback_go_to_website',API_URL:'https://graph.facebook.com/',INSIGHTS_LABEL:"See Insights...",EDIT_LABEL:"Edit Call-to-Action...",DELETE_LABEL:"Delete Call-to-Action",TEST_LABEL:"Go to link",PROMOTE_LABEL:"Promote",VIEW_PROMOTION_LABEL:"View Promotion",DELETE_DIALOG_TITLE:"Delete Call-to-Action Button",DELETE_DIALOG_MESSAGE:"Do you really want to delete the call-to-action button from your Facebook Page?",CREATE_LABEL:"Create Call-to-Action",CREATE_TOOLTIP:"Add a button to get people to take an action from your Page such as shop or sign up",PROMOTE_LABEL:"Promote",VIEW_PROMOTION_LABEL:"View Promotion",PROMOTION_CREATE_DIALOG_TITLE:"Promote Call-to-action",PROMOTION_EDIT_DIALOG_TITLE:"Edit Call-to-action Promotion",CREATE_DIALOG_TITLE:"Add Call-to-Action Button",CREATE_DIALOG_BODY_MESSAGE:"Add a button to your Page that takes people directly to your app or website.",CREATE_DIALOG_BODY_MESSAGE_IOS:"Choose where to send people when they tap the button on an iPhone or an iPad.",CREATE_DIALOG_APPLINK_MESSAGE_IOS:"Add the iOS a deep link URL for your app.",CREATE_DIALOG_APPLINK_MESSAGE_ANDROID:"Add the Android a deep link URL for your app.",CREATE_DIALOG_BACKUP_LINK_MESSAGE:"Enter where to send people who don't have the app installed. If left blank it will open the website entered in the previous screen.",CREATE_DIALOG_BODY_MESSAGE_ANDROID:"Choose where to send people when they tap the button on Android.",EDIT_SECTION_MESSAGE:"These are the destination website and app links we'll send people to after they click or tap your call-to-action button:",EDIT_SECTION_EXAMPLE:"For example, you may want to send someone using a mobile device to your app, or to your website if theyre on a desktop computer.",CREATE_DIALOG_PACKAGE_NAME_MESSAGE_ANDROID:"Add the package name of your app",EDIT_SECTION_APP_LINK_HELP_MESSAGE:"Have an app or mobile website that was not found?",CREATE_LOADING_MESSAGE:"Finding websites and apps connected to your Page...",CREATE_SELECT_CTA_LABEL:"Button Label",CREATE_INVALID_WEB_LINK:"Invalid link or URL",CREATE_INVALID_PACKAGE_NAME:"Invalid package name",CREATE_INVALID_APP_LINK:"Invalid app link",CREATE_IPHONE_DEEP_LINK_TEXT:"We will open the app selected above if installed",CREATE_ANDROID_DEEP_LINK_TEXT:"We will open the app selected above if installed",CREATE_INVALID_URL_LINK:"Invalid URL link",EDIT_CARD_WEB_TITLE:"Computer",EDIT_CARD_IOS_TITLE:"iPhone or other iOS device",EDIT_CARD_ANDROID_TITLE:"Android phone or tablet",EDIT_CARD_OTHER_M_TITLE:"Other smartphone",EDIT_LINK_TOOLTIP:"Make changes to this link address",WEB_LINK_INPUT_LABEL:"Website",WEB_LINK_INPUT_PLACEHOLDER:g._("Example: {url}",[g.param("url",'www.mywebsite.com')]),MOBILE_LINK_INPUT_LABEL:"Mobile Website",PACKAGE_NAME_LABEL:"Android Package Name",APP_LINK_INPUT_LABEL:"App Link",APP_LINK_INPUT_LABEL_TOOLTIP:"This is the link address people will go to after tapping or clicking on your call-to-action button",APP_LINK_INPUT_PLACEHOLDER:"Enter a link to your app",APP_DESTINATION_SELECTOR_LABEL:"Destination",APP_DESTINATION_SELECTOR_LABEL_TOOLTIP:"Choose the type of destination you want people to go to after tapping or clicking on your call-to-action button",FALLBACK_CTA_SELECTOR_LABEL:"Backup",FALLBACK_CTA_SELECTOR_LABEL_TOOLTIP:"Choose the type of destination you want people to go to after tapping or clicking on your call-to-action button if they haven't yet registered or installed your app",FALLBACK_LINK_INPUT_LABEL:"Backup URL",FALLBACK_LINK_INPUT_LABEL_TOOLTIP:"This is the link address people will go to after tapping or clicking on your call-to-action button if they haven't yet registered or installed your app",STORE_ID_LABEL:"Store ID",STORE_ID_TOOLTIP:"ID of app in Apple store or Google play store",GO_TO_WEBSITE_LABEL:"Go to Website",PACKAGE_NAME_LABEL:"Package Name",REVIEW_DESTINATION_LINKS_TITLE:"Review Button Destination Links",CREATE_CALL_TO_ACTION_WEBSITE:"Create a Call-To-Action Button",CREATE_CALL_TO_ACTION_IPHONE:"Choose a Destination For People Using iOS",CREATE_CALL_TO_ACTION_ANDROID:"Choose a Destination For People Using an Android",CREATE_CALL_TO_ACTION_IPAD:"Choose a Destination For People Using iPad",ACTION_SELECTOR_LABEL:"Choose a Button",OPTIONAL_LABEL:"Optional",IOS_SECTION_TITLE:"iOS Destination",ANDROID_SECTION_TITLE:"Android Destination",BACKUP_LINK_LABEL:"Backup Destination",DEEPLINK_LEARN_MORE_LABEL:"Learn how to set up a deep link",SELECTOR_OPTION_WEBSITE:"Website",SELECTOR_OPTION_APP:"App",LEGEND_KEY_ORGANIC:"Organic",LEGEND_KEY_PAID:"Paid",THIS_WEEK_CLICK_LABEL:"Clicks This Week"};e.exports=k;},null);
__d("validateDeepLink",["AdsCreationConfig","URIRFC3986","arrayContains","trim"],function(a,b,c,d,e,f,g,h,i,j){'use strict';var k=g.deepLinkBlacklist.map(function(m){return new RegExp(j(m,'/'));});function l(m){m=m.toLowerCase();var n=m.indexOf('://');if(n===-1)return false;var o=m.slice(0,n);if(o&&o.contains('.')){if(!/^[a-z0-9][a-z0-9+-.]*$/.test(o))return false;}else{var p=h.parse(m);if(!p.scheme||!/^([a-z][a-z0-9+-.]*):/i.test(m))return false;}if(i(['http','https'],o))return true;var q=k.some(function(r){return r.test(m);});return !q;}e.exports=l;},null);
__d("XCctaCreateControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/ccta\/create\/",{});},null);
__d("CctaStore",["copyProperties","ads-lib-urllib","AsyncRequest","Arbiter","CustomCTAAppConfig","CustomCTAConstants","CustomCallToActionTypes","CctaDispatcher","ImmutableObject","validateDeepLink","URI","XCctaCreateControllerURIBuilder","XHRRequest"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){'use strict';var t={},u={},v=1,w={androidDeepLinkError:null,androidPackageNameError:null,androidUriError:null,iphoneDeepLinkError:null,iphoneUriError:null,mobileUriError:null,webUriError:null},x=false,y=false,z=null,aa={showingDialog:{},showingFinishDialog:{}},ba={ctaFocusWebUri:{},ctaFocusMsite:{},iphoneFocusDeepLink:{},iphoneFocusURI:{},androidFocusPackageName:{},androidFocusDeepLink:{},androidFocusURI:{}},ca=function(){v=1;},da=function(){w={};},ea=function(){t={};},fa=function(ta){var ua=h.normalize(ta);return h.isUrl(ua);},ga=function(){if(!(t.androidPackageName)){w.androidPackageNameError=l.CREATE_INVALID_PACKAGE_NAME;return false;}var ta=t.androidPackageName.split(".");if(ta.length<=1)return false;for(var ua=0;ua<ta.length;ua++)if(!(ta[ua].trim()))return false;return true;},ha=function(ta){var ua=ta.trim();return (((ua.length>7&&ua.substr(0,7)==="http://")||(ua.length>8&&ua.substr(0,8)==="https://")));},ia=function(ta){var ua=ta.indexOf("://"),va=ta.substr(0,ua);if(va.indexOf(":")>-1||va.indexOf(";")>-1||va.indexOf(",")>-1||va.indexOf("/")>-1)return false;return true;},ja=function(){if(!(t.iphoneDeepLink))return false;if(ha(t.iphoneDeepLink))return false;if(!p(t.iphoneDeepLink))return false;if(!ia(t.iphoneDeepLink))return false;return true;},ka=function(){if(!(t.androidDeepLink))return true;if(ha(t.androidDeepLink))return false;if(!p(t.androidDeepLink))return false;if(!ia(t.androidDeepLink))return false;return true;},la=function(){if(!(t.mobileURI))return true;return fa(t.mobileURI);},ma=function(){if(!(t.webURI)){w.webUriError=l.CREATE_INVALID_WEB_LINK;return false;}if(!fa(t.webURI)){w.webUriError=l.CREATE_INVALID_WEB_LINK;return false;}return true;},na=function(){if(!(t.iphoneURI))return true;if(fa(t.iphoneURI)){return true;}else{w.iphoneUriError=l.CREATE_INVALID_WEB_LINK;return false;}},oa=function(){if(!(t.androidURI)){if(t.androidFBAppID===l.OPEN_WEBSITE_ID){w.androidUriError=l.CREATE_INVALID_WEB_LINK;return false;}return true;}return fa(t.androidURI);},pa=function(ta,ua){if(ta&&ta.url){t.iphoneFBAppID=l.OPEN_APP_ID;t.iphoneDeepLink=ta.url;}else t.iphoneFBAppID=l.OPEN_WEBSITE_ID;if(ua&&ua.url&&ua["package"]){t.androidFBAppID=l.OPEN_APP_ID;t.androidDeepLink=ua.url;t.androidPackageName=ua["package"];}else t.androidFBAppID=l.OPEN_WEBSITE_ID;n.addPostDispatchCallback(function(){n.cctaDispatch({actionType:'clear-loading'});});},qa=function(){y=true;var ta=new q(l.API_URL);ta.addQueryData({access_token:k.access_token,ids:t.webURI,type:'al'});z=new s(ta);z.setErrorHandler(function(ua){n.addPostDispatchCallback(function(){n.cctaDispatch({actionType:'clear-loading'});});}.bind(this)).setResponseHandler(function(ua){var va=JSON.parse(ua)[t.webURI],wa=(va.ios)?va.ios.pop():null,xa=(va.android)?va.android.pop():null;pa(wa,xa);}.bind(this)).setMethod('GET').send();}.bind(this),ra=function(){if(v===1){var ta=ma(),ua=la();if(ta&&ua){return true;}else if(!ta){ba.ctaFocusWebUri[t.pageID]=true;}else ba.ctaFocusMsite[t.pageID]=true;}else if(v===2){if(t.iphoneFBAppID===l.OPEN_WEBSITE_ID){if(na())return true;}else if(t.iphoneFBAppID===l.OPEN_APP_ID){var va=na(),wa=ja();if(va&&wa){return true;}else if(!wa){ba.iphoneFocusDeepLink[t.pageID]=true;}else ba.iphoneFocusURI[t.pageID]=true;}else if(na())return true;}else if(v===3)if(t.androidFBAppID===l.OPEN_WEBSITE_ID){if(oa())return true;}else if(t.androidFBAppID===l.OPEN_APP_ID){var xa=oa(),ya=ga(),za=ka();if(xa&&za&&ya){return true;}else if(!ya){ba.androidFocusPackageName[t.pageID]=true;}else if(!za){ba.androidFocusDeepLink[t.pageID]=true;}else ba.androidFocusURI[t.pageID]=true;}else if(oa()&&ga())return true;return false;},sa=g(new j(),{getError:function(ta){if(ta in w)return w[ta];return null;},getFocused:function(ta,ua){if(ua in ba&&ta in ba[ua])return ba[ua][ta];return false;},getUi:function(ta,ua){if(ua in aa&&ta in aa[ua])return aa[ua][ta];return false;},getIsLoading:function(){return y;},getConfirmationDialog:function(){return x;},getData:function(){return new o(t);},getDataCopy:function(){t.page_id=t.pageID;return t;},getApps:function(){return new o(u);},getStep:function(){return v;},getPageID:function(){return t.pageID;},getIphoneApp:function(){return 'iphoneFBAppID' in t?t.iphoneFBAppID:l.OPEN_WEBSITE_ID;},getAndroidApp:function(){return 'androidFBAppID' in t?t.androidFBAppID:2;},getIphoneAndroidWebsite:function(){if('mobileURI' in t){return t.mobileURI;}else return t.weburl;},getIphoneBackup:function(){if('iphoneAppStoreUrl' in t){return t.iphoneAppStoreUrl;}else return t.weburl;},getAndroidBackup:function(){if('iphoneAppStoreUrl' in t){return t.iphoneAppStoreUrl;}else return t.weburl;},isInitialized:function(){var ta=o.values(this.getData()).length;return ta>0;},saveDataToServer:function(){if(t.webURI)t.webURI=h.normalize(t.webURI);if(t.mobileURI)t.mobileURI=h.normalize(t.mobileURI);if(t.iphoneURI)t.iphoneURI=h.normalize(t.iphoneURI);if(t.androidURI)t.androidURI=h.normalize(t.androidURI);new i().setURI(new r().getURI()).setData({payload_json:JSON.stringify(t)}).setHandler(function(ta){if(ta.payload)n.dispatch({actionType:'saved-to-server',data:ta.payload});}.bind(this)).send();},dispatchToken:n.register(function(ta){var ua=true;switch(ta.actionType){case 'saved-to-server':aa.showingDialog[ta.data.payload.pageID]=false;if(!('cctaID' in t))aa.showingFinishDialog[ta.data.payload.pageID]=true;t=ta.data.payload;ca();da();break;case 'deleted-to-server':aa.showingDialog[ta.data.payload.pageID]=false;t=ta.data.payload;ca();da();break;case 'update-from-server':ca();da();ea();y=false;g(t,ta.data);if(!t.ctaType)t.ctaType=m.SHOP_NOW;break;case 'get-apps-from-server':u=ta.data;break;case 'update-cta-type':t.ctaType=ta.data;break;case 'update-weburl':t.webURI=ta.data;break;case 'check-weburl':if(ma()){w.webUriError=null;}else w.webUriError=l.CREATE_INVALID_WEB_LINK;break;case 'update-msite':t.mobileURI=ta.data;break;case 'check-msite':if(la()){w.mobileUriError=null;}else w.mobileUriError=l.CREATE_INVALID_WEB_LINK;break;case 'update-iphone-appselection':t.iphoneFBAppID=ta.data;break;case 'update-iphone-url':t.iphoneURI=ta.data;break;case 'check-iphone-url':if(na()){w.iphoneUriError=null;}else w.iphoneUriError=l.CREATE_INVALID_WEB_LINK;break;case 'update-iphone-deeplink':t.iphoneDeepLink=ta.data;break;case 'check-iphone-deeplink':if(ja()){w.iphoneDeepLinkError=null;}else w.iphoneDeepLinkError=l.CREATE_INVALID_APP_LINK;break;case 'update-iphone-appstore-url':t.iphoneAppStoreUrl=ta.data;break;case 'update-android-appselection':t.androidFBAppID=ta.data;if(t.androidFBAppID in u){t.androidPackageName=u[t.androidFBAppID].androidStoreID;}else t.androidPackageName="";break;case 'update-android-url':t.androidURI=ta.data;w.androidUriError=null;break;case 'check-android-url':if(oa()){w.androidUriError=null;}else w.androidUriError=l.CREATE_INVALID_WEB_LINK;break;case 'update-android-deeplink':t.androidDeepLink=ta.data;w.androidDeepLinkError=null;break;case 'check-android-deeplink':if(ka()){w.androidDeepLinkError=null;}else w.androidDeepLinkError=l.CREATE_INVALID_WEB_LINK;break;case 'update-android-package-name':t.androidPackageName=ta.data;w.androidPackageNameError=null;break;case 'check-android-package-name':if(ga()){w.androidPackageNameError=null;}else w.androidPackageNameError=l.CREATE_INVALID_PACKAGE_NAME;break;case 'update-android-appstore_url':t.androidAppStoreUrl=ta.data;break;case 'update-ipad-appselection':t.ipadAppSelection=ta.data;break;case 'update-ipad-deeplink':t.ipadDeepLink=ta.data;break;case 'update-ipad-appstore-url':t.ipadAppStoreUrl=ta.data;break;case 'update-showing-dialog':aa.showingDialog[ta.data]=!aa.showingDialog[ta.data];if(!aa.showingDialog[ta.data]){ca();da();y=false;if(z){z.abort();z=null;}}break;case 'update-showing-finish-dialog':aa.showingFinishDialog[ta.data]=!aa.showingFinishDialog[ta.data];break;case 'show-confirmation-dialog':aa.showingFinishDialog[ta.data]=!aa.showingFinishDialog[ta.data];x=!x;break;case 'delete-confirmation-dialog':x=!x;break;case 'clear-focused':ba={ctaFocusWebUri:{},ctaFocusMsite:{},iphoneFocusDeepLink:{},iphoneFocusURI:{},androidFocusPackageName:{},androidFocusDeepLink:{},androidFocusURI:{}};break;case 'clear-loading':y=!y;break;case 'decrease-step':if(v>1)v=v-1;break;case 'increase-step':if(ra())if(v===3){sa.saveDataToServer();}else{if(v===1)if(!t.cctaID){qa();t.iphoneURI=t.mobileURI||t.webURI;if(!t.iphoneFBAppID)t.iphoneFBAppID=l.OPEN_WEBSITE_ID;t.androidURI=t.mobileURI||t.webURI;if(!t.androidFBAppID)t.androidFBAppID=l.OPEN_WEBSITE_ID;}v=v+1;}break;}if(ua)sa.inform('change');})});e.exports=sa;},null);
__d("StoreBasedStateMixinHelper",["SubscriptionsHandler","invariant"],function(a,b,c,d,e,f,g,h){'use strict';function i(j){h(j.length>0);this.$StoreBasedStateMixinHelper0=j;this.$StoreBasedStateMixinHelper1=new g();}i.prototype.subscribeCallback=function(j){var k=this.$StoreBasedStateMixinHelper0.map(function(l){if(l.subscribe){return l.subscribe('change',j);}else if(l.addListener){return l.addListener('change',j);}else h(false);});this.$StoreBasedStateMixinHelper1.addSubscriptions.apply(this.$StoreBasedStateMixinHelper1,k);};i.prototype.release=function(){this.$StoreBasedStateMixinHelper1.release();};e.exports=i;},null);
__d("PureStoreBasedStateMixin",["StoreBasedStateMixinHelper","invariant"],function(a,b,c,d,e,f,g,h){'use strict';var i=function(){for(var j=[],k=0,l=arguments.length;k<l;k++)j.push(arguments[k]);return {getInitialState:function(){return this.constructor.calculateState();},componentWillMount:function(){h(this.constructor.calculateState);this._mixin=new g(j);this._mixin.subscribeCallback(function(){this.setState(this.constructor.calculateState());}.bind(this));},componentWillUnmount:function(){this._mixin.release();}};}.bind(this);e.exports=i;},null);
__d("ContextualDialogLockOnClick",["Event","LayerHideOnBlur","SubscriptionsHandler"],function(a,b,c,d,e,f,g,h,i){var j=1000;function k(l){"use strict";this.$ContextualDialogLockOnClick0=l;}k.prototype.enable=function(){"use strict";this.$ContextualDialogLockOnClick1=new i();this.$ContextualDialogLockOnClick1.addSubscriptions(this.$ContextualDialogLockOnClick0.subscribe('show',this.$ContextualDialogLockOnClick2.bind(this)),this.$ContextualDialogLockOnClick0.subscribe('hide',this.$ContextualDialogLockOnClick3.bind(this)),g.listen(this.$ContextualDialogLockOnClick0.getRoot(),'click',this.$ContextualDialogLockOnClick4.bind(this)),g.listen(this.$ContextualDialogLockOnClick0.getCausalElement(),'click',this.$ContextualDialogLockOnClick5.bind(this)));};k.prototype.disable=function(){"use strict";this.$ContextualDialogLockOnClick0.unlockHover();this.$ContextualDialogLockOnClick1.release();};k.prototype.$ContextualDialogLockOnClick2=function(){"use strict";if(this.$ContextualDialogLockOnClick0.hasBehavior(h)){this.$ContextualDialogLockOnClick0.disableBehavior(h);setTimeout(this.$ContextualDialogLockOnClick0.enableBehavior.bind(this.$ContextualDialogLockOnClick0,h),j);}};k.prototype.$ContextualDialogLockOnClick3=function(){"use strict";this.$ContextualDialogLockOnClick0.unlockHover();};k.prototype.$ContextualDialogLockOnClick4=function(){"use strict";this.$ContextualDialogLockOnClick0.lockHover();};k.prototype.$ContextualDialogLockOnClick5=function(){"use strict";this.$ContextualDialogLockOnClick0.lockHover();this.$ContextualDialogLockOnClick0.show();};e.exports=k;},null);
__d("PagesManagerSpringboardMetric.react",["ContextualDialogLockOnClick","ContextualLayerHideOnScroll","SpectrumIntegerScale","LayerFadeOnHide","LayerFadeOnShow","LayerHideOnTransition","LayerHideOnBlur","LayerHideOnEscape","LayerRemoveOnHide","Link.react","React","ReactLayeredComponentMixin","Style","UIPagelet","Vector","XUIContextualDialog.react","XUISpinner.react","XUIText.react","cx","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){var aa=q.PropTypes,ba=30*1000,ca=300,da=1e+06,ea=500,fa=25,ga=q.createClass({displayName:"PagesManagerSpringboardMetric",mixins:[r],propTypes:{adjustFlyoutPositionOnload:aa.bool,count:aa.number.isRequired,itemKey:aa.string.isRequired,flyoutWidth:aa.number,label:aa.string.isRequired,onFlyoutToggle:aa.func,pagelet:aa.object,hasFlyout:aa.bool,showFlyout:aa.bool},getDefaultProps:function(){return {hasFlyout:true};},getInitialState:function(){return {count:0};},componentDidMount:function(){this._onToggle(this.props.showFlyout);this._animateToNewCount(this.props.count);},componentWillReceiveProps:function(ha){if(ha.count!==this.props.count){this._expireCache();this._animateToNewCount(ha.count);}},render:function(){var ha=Math.round(this.state.count);if(ha>=da){ha=i().tickFormat()(ha);}else ha=i().tooltipFormat()(ha);var ia;if(this.props.hasFlyout){ia=q.createElement(p,q.__spread({},this.props,{ref:"metric"}),q.createElement("span",{className:"_5vh0"},ha),q.createElement("span",{className:"_5vh1"},this.props.label));}else ia=q.createElement(x,{size:"medium",display:"block",ref:"metric"},q.createElement("span",{className:"_5vh0"},ha),q.createElement("span",{className:"_xep"},this.props.label));return (q.createElement("li",{className:"_5vg_"},ia));},renderLayers:function(){if(!this.props.hasFlyout)return null;return {metricsFlyout:q.createElement(v,{behaviors:{ContextualDialogLockOnClick:g,ContextualLayerHideOnScroll:h,LayerFadeOnHide:j,LayerFadeOnShow:k,LayerHideOnTransition:l,LayerHideOnBlur:m,LayerHideOnEscape:n,LayerRemoveOnHide:o},contextRef:"metric",hoverContext:this.refs.metric.getDOMNode(),hoverShowDelay:ca,onToggle:this._onToggle,position:"left",shown:this.props.showFlyout,width:this.props.flyoutWidth},q.createElement("div",{className:"_5x0l",ref:"flyout"},q.createElement("div",{className:"_5x0m"},q.createElement(w,{size:"large"}))))};},_expireCache:function(){this._cacheExpires=0;},_onToggle:function(ha){if(this.props.onFlyoutToggle)this.props.onFlyoutToggle(ha,this.props.itemKey);if(!this.props.hasFlyout)return;if(ha){var ia=Date.now();if(ia>(this._cacheExpires||0)){this._cacheExpires=ia+ba;t.loadFromEndpoint(this.props.pagelet.name,this.refs.flyout.getDOMNode(),this.props.pagelet.data,this.props.adjustFlyoutPositionOnload?{handler:this._onFlyoutLoad}:null);}}},_onFlyoutLoad:function(){var ha=z('pagesManagerSpringboard');if(!ha)return;var ia=u.getElementPosition(this.refs.metric.getDOMNode()),ja=u.getElementPosition(ha),ka=ia.y-ja.y,la=u.getElementDimensions(this.refs.flyout.getDOMNode()).y;if(ka<la)s.set(this.refs.flyout.getDOMNode().offsetParent,'top',-ka+'px');},_animateToNewCount:function(ha){var ia=ea/fa,ja=ha-this.state.count,ka=ja/ia,la=0,ma=setInterval(function(){if(++la>=ia){clearInterval(ma);return this.setState({count:ha});}var na=this.state.count+ka;this.setState({count:na});}.bind(this),fa);}});e.exports=ga;},null);
__d("PagesManagerSpringboard.react",["ApiClient","Arbiter","AsyncRequest","BoostedPagelikeConstants","BoostedActionType","CustomCTAConstants","CctaConfirmationDialog.react","d3/time/day","DOM","ge","HubbleApiWrapper","HubbleConstants","HubbleContext","InsightsUtils","PagesManagerSpringboardMetric.react","React","ReactLayeredComponentMixin","Run","tidyEvent","PureStoreBasedStateMixin","CctaStore","URI","cx","fbt","invariant","mapObject","formatDate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){var ha=v.PropTypes,ia=['page_posts_impressions_unique','page_fan_adds_unique'],ja=2*60*1000,ka={ADS_RUNNING:'ads_running',CALL_TO_ACTION:'call_to_action',PAGE_LIKES:'page_likes',POST_REACH:'post_reach',QRCODE_SCANS:'qrcode_scans',NOTIFICATIONS:'notifications',MESSAGES:'messages'};function la(na){var oa=0;if(na)na.forEach(function(pa){oa+=pa;});return oa;}var ma=v.createClass({displayName:"PagesManagerSpringboard",mixins:[z(aa),w],propTypes:{context:ha.object,pageInfo:ha.object.isRequired,canSeePageLikeAds:ha.bool,canSeePagePostAds:ha.bool,activePageLikeAds:ha.number,activeBoostedPostAds:ha.number,unreadNotifications:ha.number,unreadMessages:ha.number,callToActionClicks:ha.number,callToActionPaidClicks:ha.number,canSeeMessages:ha.bool,canSeeInsights:ha.bool,canSeeLabelFans:ha.number,initalCanSeeCallToAction:ha.bool,newLikesCount:ha.number,qrId:ha.number,qrScansCount:ha.number},statics:{calculateState:function(){return {showConfirmation:aa.getConfirmationDialog()};}},getInitialState:function(){var na=fa(this.props.mostRecentTimes,function(qa){return t.pacificSecondsToUTCDate(qa);}),oa=new Date(Math.min(na[r.PIPELINE_DAILY],na[r.PIPELINE_WEEKLY])),pa=n.utc.offset(oa,-7);return {activeFlyoutKey:null,postReach:0,pageLikes:0,callToActionClicks:0,callToActionPaidClicks:0,canSeeCallToAction:this.props.initialCanSeeCallToAction,activePageLikeAds:this.props.activePageLikeAds||0,activeBoostedPostAds:this.props.activeBoostedPostAds||0,unreadNotifications:this.props.unreadNotifications||0,unreadMessages:this.props.unreadMessages||0,insightSince:pa,insightUntil:oa};},componentWillMount:function(){if(this.props.canSeeInsights){ea(this.props.context);g.setClientID(this.props.context.appID);g.setAccessToken(this.props.context.accessToken);s.setContext(this.props.context);this._gatherInsights();}if(this.props.canSeeMessages){var na=p('pages_manager_flyout_messages');if(na)o.remove(na);}var oa=ba.getRequestURI().getQueryData();if(oa.promoted_like)new i().setURI('/ajax/ads/boosted_pagelike/create.php').setData({pageid:this.props.pageInfo.id,ref:oa.ref}).send();this._cctaSubscription=aa.subscribe('change',function(){if(aa.isInitialized())this.setState({canSeeCallToAction:!!aa.getData().cctaID});}.bind(this));},componentDidMount:function(){if(this.props.canSeeInsights){var na=setInterval(this._gatherInsights,ja);x.onLeave(function(){clearInterval(na);});}if(this.props.canSeeMessages)y(h.subscribe('pagesManagerMessaging/messageUnreadCountUpdated',function(oa,pa){this.setState({unreadMessages:pa.metricCount});}.bind(this)));if(this.props.canSeePageLikeAds)y(h.subscribe(j.PANEL_STATUS_CHANGE_FINISH,function(oa,pa){var qa=pa.active?1:0;if(this.state.activePageLikeAds!==qa&&pa.action_type===k.PAGELIKE)this.setState({activeFlyoutKey:ka.PAGE_LIKES,activePageLikeAds:qa});}.bind(this)));if(this.state.canSeeCallToAction)y(h.subscribe(l.SHOW_FLYOUT,function(oa,pa){this.setState({activeFlyoutKey:ka.CALL_TO_ACTION});}.bind(this)));},renderLayers:function(){if(this.state.showConfirmation)return (v.createElement(m,{createButton:this.refs.ctaSpringBoard,pageid:this.props.pageInfo.id}));},render:function(){return (v.createElement("div",{className:"_5vgz",id:"pagesManagerSpringboard"},this._renderThisWeekData(),this._renderUnread()));},_renderThisWeekData:function(){var na=[];na.push(this._renderAds());na.push(this._renderNewLikes());na.push(this._renderPostReach());na.push(this._renderQRScans());na.push(this._renderCallToAction());if(!na.length)return null;na.unshift(v.createElement("div",{className:"_5vg-"},v.createElement("h4",null,"This week")));return na;},_renderAds:function(){if(!this.props.showAdsRunning||(!this.props.canSeePageLikeAds&&!this.props.canSeePagePostAds))return null;var na=(this.props.canSeePageLikeAds?this.state.activePageLikeAds:0)+(this.props.canSeePagePostAds?this.state.activeBoostedPostAds:0);return (v.createElement("ul",null,v.createElement(u,{itemKey:ka.ADS_RUNNING,showFlyout:this.state.activeFlyoutKey===ka.ADS_RUNNING,onFlyoutToggle:this._onFlyoutToggle,pagelet:{name:'PagesManagerSpringboardActiveAdsPagelet',data:{page_id:this.props.pageInfo.id,page_like_eligible:this.props.canSeePageLikeAds,page_post_eligible:this.props.canSeePagePostAds,active_boosted_post_ads:this.state.activeBoostedPostAds}},flyoutWidth:290,count:na,label:da._({"Ad":"Ad Running","Ads":"Ads Running"},[da['enum'](this.state.activeAdCount===1?'Ad':'Ads',{Ad:"Ad",Ads:"Ads"})])})));},_renderNewLikes:function(){var na=this.props.pageInfo,oa=this.props.canSeeLabelFans?372:290,pa=n.utc.offset(this.state.insightUntil,-1),qa=0;if(this.props.canSeeInsights){qa=this.state.pageLikes;}else qa=this.props.newLikesCount;return (v.createElement("ul",null,v.createElement(u,{itemKey:ka.PAGE_LIKES,showFlyout:this.state.activeFlyoutKey===ka.PAGE_LIKES,onFlyoutToggle:this._onFlyoutToggle,pagelet:{name:'PagesManagerSpringboardNewLikesPagelet',data:{page_id:na.id,count:qa,width:oa,since:ga(this.state.insightSince,'m/d/Y',{utc:true}),until:ga(pa,'m/d/Y',{utc:true}),since_timestamp:t.dateToSeconds(this.state.insightSince)}},flyoutWidth:oa,count:qa,label:da._({"Like":"Page Like","Likes":"Page Likes"},[da['enum'](this.state.pageLikes===1?'Like':'Likes',{Like:"Like",Likes:"Likes"})])})));},_renderPostReach:function(){if(!this.props.canSeeInsights)return null;var na=this.props.pageInfo,oa=n.utc.offset(this.state.insightUntil,-1);return (v.createElement("ul",null,v.createElement(u,{itemKey:ka.POST_REACH,showFlyout:this.state.activeFlyoutKey===ka.POST_REACH,onFlyoutToggle:this._onFlyoutToggle,pagelet:{name:'PagesManagerSpringboardPostReachPagelet',data:{page_id:na.id,context:this.props.context,since:ga(this.state.insightSince,'m/d/Y',{utc:true}),until:ga(oa,'m/d/Y',{utc:true})}},flyoutWidth:624,count:this.state.postReach,label:"Post Reach"})));},_renderQRScans:function(){if(!this.props.hasValidQRCode)return null;var na=this.props.qrScansCount,oa=430,pa=n.utc.offset(this.state.insightUntil,-1);return (v.createElement("ul",null,v.createElement(u,{itemKey:ka.QRCODE_SCANS,showFlyout:this.state.activeFlyoutKey===ka.QRCODE_SCANS,onFlyoutToggle:this._onFlyoutToggle,pagelet:{name:'PagesManagerSpringboardQRScansPagelet',data:{page_id:this.props.pageInfo.id,qr_id:this.props.qrId,since:ga(this.state.insightSince,'m/d/Y',{utc:true}),since_timestamp:t.dateToSeconds(this.state.insightSince),until:ga(pa,'m/d/Y',{utc:true})}},flyoutWidth:oa,count:na,label:da._({"Scan":"QRCode Scan","Scans":"QRCode Scans"},[da['enum'](na===1?'Scan':'Scans',{Scan:"Scan",Scans:"Scans"})])})));},_renderCallToAction:function(){if(!this.state.canSeeCallToAction)return null;return (v.createElement("ul",null,v.createElement(u,{ref:"ctaSpringBoard",itemKey:ka.CALL_TO_ACTION,showFlyout:this.state.activeFlyoutKey===ka.CALL_TO_ACTION,onFlyoutToggle:this._onFlyoutToggle,pagelet:{name:'PagesManagerSpringboardCallToActionPagelet',data:{page_id:this.props.pageInfo.id}},count:this.props.callToActionClicks+this.props.callToActionPaidClicks,flyoutWidth:328,label:"CTA Clicks"})));},_renderUnread:function(){var na=this.props.pageInfo,oa=this.state.unreadNotifications===1?'Notification':'Notifications',pa=this.state.unreadMessages===1?'Message':'Messages';return [v.createElement("div",{className:"_5vg-"},v.createElement("h4",null,"Unread")),v.createElement("ul",null,v.createElement(u,{itemKey:ka.NOTIFICATIONS,showFlyout:this.state.activeFlyoutKey===ka.NOTIFICATIONS,onFlyoutToggle:this._onFlyoutToggle,adjustFlyoutPositionOnload:true,pagelet:{name:'PagesManagerSpringboardNotificationsPagelet',data:{page_id:na.id}},flyoutWidth:430,count:this.state.unreadNotifications,label:da._({"Notification":"Notification","Notifications":"Notifications"},[da['enum'](oa,{Notification:"Notification",Notifications:"Notifications"})])}),(this.props.canSeeMessages)?v.createElement(u,{itemKey:ka.MESSAGES,showFlyout:this.state.activeFlyoutKey===ka.MESSAGES,onFlyoutToggle:this._onFlyoutToggle,adjustFlyoutPositionOnload:true,pagelet:{name:'PagesManagerSpringboardMessagesPagelet',data:{page_id:na.id}},flyoutWidth:430,count:this.state.unreadMessages,label:da._({"Message":"Message","Messages":"Messages"},[da['enum'](pa,{Message:"Message",Messages:"Messages"})])}):null)];},_gatherInsights:function(){q.getPageInsights({metric:ia,since:this.state.insightSince,until:this.state.insightUntil},this._handleNewData);},_handleNewData:function(na){var oa=na.values,pa=[this.state.pageLikes];if(oa.page_fan_adds_unique){var qa=r.PERIOD_DAY;pa=oa.page_fan_adds_unique[qa].slice(-7);}var ra=[this.state.postReach];if(oa.page_posts_impressions_unique){var sa=r.PERIOD_WEEK;ra=oa.page_posts_impressions_unique[sa].slice(6);}this.setState({pageLikes:la(pa),postReach:la(ra)});},_onFlyoutToggle:function(na,oa){if(na){this.setState({activeFlyoutKey:oa});}else if(this.state.activeFlyoutKey===oa)this.setState({activeFlyoutKey:null});}});e.exports=ma;},null);